
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Workout App with Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen;
      background: #ffffff;
      color: #333;
      margin: 0;
      padding: 0;
    }
    header {
      text-align: center;
      padding: 1em;
      padding-top: env(safe-area-inset-top);
      background: #e3f2fd;
      font-size: 1.5em;
      font-weight: bold;
    }
    nav {
      display: flex;
      justify-content: space-around;
      background: #bbdefb;
    }
    nav button {
      flex: 1;
      padding: 1em;
      border: none;
      background: #bbdefb;
      font-size: 1em;
      cursor: pointer;
    }
    nav button.active {
      background: #64b5f6;
      font-weight: bold;
    }
    .tab-content {
      display: none;
      padding: 1em;
    }
    .tab-content.active {
      display: block;
    }
    .btn {
      display: block;
      width: 100%;
      margin: 0.6em auto;
      padding: 1.2em;
      font-size: 1.1em;
      border: none;
      border-radius: 10px;
      background-color: #42a5f5;
      color: white;
      transition: background-color 0.3s ease;
      cursor: pointer;
    }
    .btn:hover {
      opacity: 0.9;
    }
    #timer {
      font-size: 3em;
      margin-top: 1.5em;
      color: #333;
      padding: 10px;
      border-radius: 8px;
      background-color: #e0f7fa;
      transition: background-color 0.4s ease;
      text-align: center;
    }
    .yellow { background-color: #fff59d !important; }
    .red { background-color: #ef9a9a !important; }

    textarea {
      width: 100%;
      height: 150px;
      font-family: monospace;
      margin-top: 1em;
      padding: 1em;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .output-wrapper {
      overflow-x: auto;
      margin-top: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #f5f5f5;
      padding: 1em;
    }
    .output {
      white-space: pre;
      font-family: monospace;
      font-size: 0.95em;
      min-width: 600px;
    }
    .tracker {
      max-width: 400px;
      margin: 0 auto;
      background: white;
      padding: 1.2em;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      font-size: 1.2em;
    }
    .workout {
      padding: 1em 0;
      border-bottom: 1px solid #eee;
    }
    .success {
      background: #e8f5e9;
      color: #2e7d32;
      text-align: center;
      font-weight: bold;
      padding: 0.5em;
      border-radius: 5px;
      margin-top: 1em;
      display: none;
    }
    .streak {
      text-align: center;
      margin-top: 0.5em;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>Workout Rest Timer + Plans</header>
  <nav>
    <button class="tab-button active" onclick="switchTab('timer-tab')">Timer</button>
    <button class="tab-button" onclick="switchTab('workout-tab')">Workout</button>
    <button class="tab-button" onclick="switchTab('meal-tab')">Meals</button>
    <button class="tab-button" onclick="switchTab('shop-tab')">Shopping</button>
    <button class="tab-button" onclick="switchTab('tracker-tab')">Tracker</button>
  </nav>

  <div class="tab-content active" id="timer-tab">
    <button class="btn" onclick="startTimer(30)">30s (Superset / Drop Set)</button>
    <button class="btn" onclick="startTimer(45)">45s (Isolation Set Recovery)</button>
    <button class="btn" onclick="startTimer(60)">60s (Standard Set Rest)</button>
    <button class="btn" onclick="startTimer(90)">90s (Heavy Set Recovery)</button>
    <button class="btn" onclick="startTimer(120)">2 min (Compound Lift Rest)</button>
    <button class="btn" onclick="startTimer(180)">3 min (Rest Between Exercises)</button>
    <button class="btn" onclick="resetTimer()">Reset Timer</button>
    <div id="timer">00:00</div>
  </div>

  <div class="tab-content" id="workout-tab">
    <textarea id="workoutInput" placeholder="Paste your workout plan here..."></textarea>
    <button class="btn" onclick="savePlan('workout')">Save Workout</button>
    <div class="output-wrapper"><pre id="workoutOutput" class="output"></pre></div>
  </div>

  <div class="tab-content" id="meal-tab">
    <textarea id="mealInput" placeholder="Paste your meal plan here..."></textarea>
    <button class="btn" onclick="savePlan('meal')">Save Meal Plan</button>
    <div class="output-wrapper"><pre id="mealOutput" class="output"></pre></div>
  </div>

  <div class="tab-content" id="shop-tab">
    <textarea id="shopInput" placeholder="Paste your shopping list here..."></textarea>
    <button class="btn" onclick="savePlan('shop')">Save Shopping List</button>
    <div class="output-wrapper"><pre id="shopOutput" class="output"></pre></div>
  </div>

  <div class="tab-content" id="tracker-tab">
    <h2 style="text-align:center;">Workout Habit Tracker</h2>
    <div class="tracker">
      <div class="workout"><label><input type="checkbox" class="check" data-key="workout1"> Push Day</label></div>
      <div class="workout"><label><input type="checkbox" class="check" data-key="workout2"> Pull Day</label></div>
      <div class="workout"><label><input type="checkbox" class="check" data-key="workout3"> Leg Day</label></div>
      <div class="workout"><label><input type="checkbox" class="check" data-key="workout4"> Upper Body Mix</label></div>
      <div id="successMessage" class="success">‚úÖ You hit all 4 workouts this week. Keep it up!</div>
      <div id="streakCounter" class="streak">üèÜ Weekly Streak: 0</div>
      <button class="btn" onclick="completeWeek()">Complete Week</button>
    </div>
  </div>

  
<script>
    function switchTab(tabId) {
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.querySelector(`.tab-button[onclick*="${tabId}"]`).classList.add('active');
        document.getElementById(tabId).classList.add('active');
    }

    let countdown, wakeLock = null, totalTime = 0;
    async function requestWakeLock() {
        try {
            if ('wakeLock' in navigator) {
                wakeLock = await navigator.wakeLock.request('screen');
            }
        } catch (err) {}
    }

    function startTimer(seconds) {
        clearInterval(countdown);
        requestWakeLock();
        totalTime = seconds;
        const timerDisplay = document.getElementById('timer');
        const endTime = Date.now() + seconds * 1000;

        function updateTimer() {
            const now = Date.now();
            const remaining = Math.max(0, endTime - now);
            const minutes = Math.floor(remaining / 1000 / 60);
            const secs = Math.floor((remaining / 1000) % 60);
            timerDisplay.textContent = minutes.toString().padStart(2, '0') + ':' + secs.toString().padStart(2, '0');
            const percentLeft = remaining / (totalTime * 1000);
            timerDisplay.classList.remove("red", "yellow");
            if (percentLeft <= 0.10) timerDisplay.classList.add("red");
            else if (percentLeft <= 0.6) timerDisplay.classList.add("yellow");

            if (remaining <= 0) {
                clearInterval(countdown);
                if (wakeLock) wakeLock.release().then(() => wakeLock = null);
            }
        }

        updateTimer();
        countdown = setInterval(updateTimer, 1000);
    }

    function resetTimer() {
        clearInterval(countdown);
        const timerDisplay = document.getElementById('timer');
        timerDisplay.textContent = "00:00";
        timerDisplay.classList.remove("red", "yellow");
        if (wakeLock) wakeLock.release().then(() => wakeLock = null);
    }

    function savePlan(type) {
        const input = document.getElementById(type + "Input").value;
        localStorage.setItem(type + "Plan", input);
        document.getElementById(type + "Output").textContent = input;
    }

    ["workout", "meal", "shop"].forEach(type => {
        const saved = localStorage.getItem(type + "Plan");
        if (saved) {
            document.getElementById(type + "Output").textContent = saved;
        }
    });

    const checkboxes = document.querySelectorAll('.check');
    const successMessage = document.getElementById('successMessage');
    const streakCounter = document.getElementById('streakCounter');
    let streak = parseInt(localStorage.getItem("weeklyStreak")) || 0;
    streakCounter.textContent = "üèÜ Weekly Streak: " + streak;

    function updateProgress() {
        let allChecked = true;
        checkboxes.forEach(box => {
            localStorage.setItem(box.dataset.key, box.checked);
            if (!box.checked) allChecked = false;
        });
        successMessage.style.display = allChecked ? "block" : "none";
    }

    function completeWeek() {
        let allDone = true;
        checkboxes.forEach(box => {
            if (!box.checked) allDone = false;
        });

        if (allDone) {
            streak += 1;
            fireConfetti();
        } else {
            streak = 0;
        }

        localStorage.setItem("weeklyStreak", streak);
        localStorage.setItem("lastReset", new Date().toDateString());
        streakCounter.textContent = "üèÜ Weekly Streak: " + streak;

        checkboxes.forEach(box => {
            box.checked = false;
            localStorage.setItem(box.dataset.key, false);
        });

        successMessage.style.display = "none";
    }

    function fireConfetti() {
        const duration = 1000;
        const interval = 200;
        const end = Date.now() + duration;
        const confettiInterval = setInterval(() => {
            if (Date.now() > end) {
                clearInterval(confettiInterval);
                return;
            }
            confetti({
                particleCount: 7,
                angle: 60,
                spread: 70,
                origin: { x: 0 }
            });
            confetti({
                particleCount: 7,
                angle: 120,
                spread: 70,
                origin: { x: 1 }
            });
        }, interval);
    }

    // Auto reset on Monday
    window.addEventListener("load", () => {
        const lastReset = localStorage.getItem("lastReset");
        const today = new Date();
        const day = today.getDay(); // 1 = Monday
        const dateStr = today.toDateString();

        if (day === 1 && lastReset !== dateStr) {
            let allDone = true;
            checkboxes.forEach(box => {
                if (!box.checked) allDone = false;
            });

            if (allDone) {
                streak += 1;
            } else {
                streak = 0;
            }

            localStorage.setItem("weeklyStreak", streak);
            streakCounter.textContent = "üèÜ Weekly Streak: " + streak;

            checkboxes.forEach(box => {
                box.checked = false;
                localStorage.setItem(box.dataset.key, false);
            });

            localStorage.setItem("lastReset", dateStr);
            successMessage.style.display = "none";
        }
    });

    checkboxes.forEach(box => {
        const saved = localStorage.getItem(box.dataset.key);
        if (saved === "true") box.checked = true;
        box.addEventListener('change', updateProgress);
    });

    updateProgress();
</script>

</body>
</html>
